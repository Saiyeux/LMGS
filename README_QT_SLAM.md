# Hybrid SLAM Qtæ¶æ„ - ä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

åŸºäºè®¾è®¡æ–¹æ¡ˆé‡æ„çš„Hybrid SLAMç³»ç»Ÿï¼Œé‡‡ç”¨Qt+OpenCV+AIæ¶æ„ï¼Œæä¾›ç»Ÿä¸€çš„è§†é¢‘æµå¤„ç†å’ŒAIé›†æˆç•Œé¢ã€‚

## æ–°æ¶æ„ç‰¹ç‚¹

### ğŸ¯ **æ ¸å¿ƒæ”¹è¿›**
- **ç»Ÿä¸€Qtç•Œé¢**ï¼šæ›¿ä»£æ··ä¹±çš„OpenCVçª—å£æ˜¾ç¤º
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¸…æ™°çš„ç»„ä»¶åˆ†ç¦»å’Œæ¥å£å®šä¹‰
- **çº¿ç¨‹å®‰å…¨**ï¼šQtä¿¡å·æ§½æœºåˆ¶ç¡®ä¿è·¨çº¿ç¨‹é€šä¿¡
- **é«˜æ€§èƒ½**ï¼šå¼‚æ­¥å¤„ç†ç®¡é“ï¼ŒGPUåŠ é€Ÿæ”¯æŒ
- **æ˜“æ‰©å±•**ï¼šæ’ä»¶å¼AIæ¨¡å‹é›†æˆ

### ğŸ— **æ¶æ„ç»„ä»¶**
1. **VideoStreamManager** - åŒæ‘„åƒå¤´åŒæ­¥é‡‡é›†
2. **AIProcessingPipeline** - AIç®—æ³•é›†æˆç®¡é“
3. **QtDisplayWidget** - ç»Ÿä¸€æ˜¾ç¤ºç•Œé¢
4. **MainWindow** - ä¸»åº”ç”¨ç¨‹åºçª—å£

## å®‰è£…ä¾èµ–

```bash
# å¿…éœ€ä¾èµ–
pip install PyQt5 opencv-python numpy

# å¯é€‰ä¾èµ–ï¼ˆAIåŠŸèƒ½ï¼‰
pip install torch torchvision
```

## ä½¿ç”¨æ–¹æ³•

### 1. å¿«é€Ÿå¯åŠ¨

```bash
# å¯åŠ¨Qtç•Œé¢
python run_qt_slam.py

# æŒ‡å®šæ‘„åƒå¤´è®¾å¤‡
python run_qt_slam.py --left-cam 0 --right-cam 1

# ç¦ç”¨AIåŠŸèƒ½ï¼Œä»…æ˜¾ç¤ºè§†é¢‘æµ
python run_qt_slam.py --no-ai

# è®¾ç½®ç›®æ ‡FPS
python run_qt_slam.py --fps 30
```

### 2. ç³»ç»Ÿæµ‹è¯•

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•
python run_qt_slam.py --test

# æ£€æŸ¥ç³»ç»Ÿä¾èµ–
python run_qt_slam.py --check-deps

# æˆ–ç›´æ¥è¿è¡Œæµ‹è¯•è„šæœ¬
python test_qt_slam.py
```

## ç•Œé¢è¯´æ˜

### ä¸»ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Hybrid SLAM Qtç³»ç»Ÿ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      å·¦æ‘„åƒå¤´           â”‚         å³æ‘„åƒå¤´                    â”‚
â”‚    (640x480)          â”‚       (640x480)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              AIå¤„ç†ç»“æœå¯è§†åŒ–              â”‚    ç³»ç»Ÿä¿¡æ¯é¢æ¿    â”‚
â”‚             (1200x400)                   â”‚   (350x400)     â”‚
â”‚                                          â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŠŸèƒ½è¯´æ˜

**è§†é¢‘æ˜¾ç¤ºåŒºåŸŸï¼š**
- å·¦æ‘„åƒå¤´ï¼šå®æ—¶æ˜¾ç¤ºå·¦æ‘„åƒå¤´è§†é¢‘æµ
- å³æ‘„åƒå¤´ï¼šå®æ—¶æ˜¾ç¤ºå³æ‘„åƒå¤´è§†é¢‘æµ
- è‡ªåŠ¨ç¼©æ”¾ä¿æŒæ¯”ä¾‹

**AIç»“æœåŒºåŸŸï¼š**
- ç‰¹å¾åŒ¹é…å¯è§†åŒ–
- å¤„ç†ç»“æœå åŠ æ˜¾ç¤º
- å®æ—¶æ€§èƒ½æŒ‡æ ‡

**ä¿¡æ¯é¢æ¿ï¼š**
- ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
- FPSç»Ÿè®¡ä¿¡æ¯
- AIå¤„ç†ç»“æœè¯¦æƒ…
- é”™è¯¯ä¿¡æ¯æ˜¾ç¤º

### èœå•åŠŸèƒ½

**æ–‡ä»¶èœå•ï¼š**
- ä¿å­˜/åŠ è½½é…ç½®
- é€€å‡ºç¨‹åº

**æ§åˆ¶èœå•ï¼š**
- å¼€å§‹/åœæ­¢ç³»ç»Ÿ
- é‡ç½®æ˜¾ç¤º

**è®¾ç½®èœå•ï¼š**
- æ‘„åƒå¤´é…ç½®
- AIæ¨¡å‹é…ç½®
- ç³»ç»Ÿå‚æ•°è°ƒæ•´

## é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶ä½ç½®ï¼š`config/qt_slam_config.json`

```json
{
  "left_device": 0,           // å·¦æ‘„åƒå¤´è®¾å¤‡ID
  "right_device": 1,          // å³æ‘„åƒå¤´è®¾å¤‡ID  
  "target_fps": 30,           // ç›®æ ‡FPS
  "enable_loftr": true,       // å¯ç”¨EfficientLoFTR
  "enable_pnp": true,         // å¯ç”¨PnPä½å§¿ä¼°è®¡
  "enable_mono_gs": false,    // å¯ç”¨MonoGSï¼ˆå®éªŒæ€§ï¼‰
  "confidence_threshold": 0.8, // åŒ¹é…ç½®ä¿¡åº¦é˜ˆå€¼
  "buffer_size": 30           // ç¼“å†²åŒºå¤§å°
}
```

## APIæ¥å£

### VideoStreamManager

```python
from hybrid_slam.core.video_stream_manager import VideoStreamManager

manager = VideoStreamManager(left_device=0, right_device=1)
manager.start_capture()
frame = manager.get_latest_frame()
stats = manager.get_stats()
manager.stop_capture()
```

### AIProcessingPipeline

```python
from hybrid_slam.core.ai_processing_pipeline import AIProcessingPipeline

pipeline = AIProcessingPipeline(config)
pipeline.initialize_models()
pipeline.start_processing()
pipeline.enqueue_frame(stereo_frame)
pipeline.stop_processing()
```

## æ€§èƒ½ä¼˜åŒ–

### 1. ç³»ç»Ÿè®¾ç½®
- ä½¿ç”¨USB 3.0æ‘„åƒå¤´è·å¾—æœ€ä½³æ€§èƒ½
- ç¡®ä¿GPUé©±åŠ¨ç¨‹åºæœ€æ–°ï¼ˆAIåŠ é€Ÿï¼‰
- å…³é—­ä¸å¿…è¦çš„åå°ç¨‹åº

### 2. é…ç½®è°ƒä¼˜
```json
{
  "target_fps": 20,          // é™ä½FPSå‡å°‘CPUè´Ÿè½½
  "buffer_size": 10,         // å‡å°ç¼“å†²åŒºèŠ‚çœå†…å­˜
  "confidence_threshold": 0.9 // æé«˜é˜ˆå€¼å‡å°‘è¯¯åŒ¹é…
}
```

### 3. AIæ¨¡å‹ä¼˜åŒ–
- ä»…å¯ç”¨éœ€è¦çš„AIåŠŸèƒ½
- ä½¿ç”¨GPUåŠ é€Ÿï¼ˆå¦‚æœå¯ç”¨ï¼‰
- è°ƒæ•´å¤„ç†åˆ†è¾¨ç‡

## æ•…éšœæ’é™¤

### 1. æ‘„åƒå¤´é—®é¢˜
```bash
# æ£€æŸ¥æ‘„åƒå¤´è®¾å¤‡
python -c "import cv2; print([cv2.VideoCapture(i).isOpened() for i in range(4)])"

# æµ‹è¯•æ‘„åƒå¤´
python run_qt_slam.py --left-cam 0 --right-cam 1 --no-ai
```

### 2. PyQt5é—®é¢˜
```bash
# é‡æ–°å®‰è£…PyQt5
pip uninstall PyQt5
pip install PyQt5

# æ£€æŸ¥Qtç¯å¢ƒ
python -c "from PyQt5.QtWidgets import QApplication; print('PyQt5 OK')"
```

### 3. AIæ¨¡å‹é—®é¢˜
```bash
# è·³è¿‡AIåŠŸèƒ½æµ‹è¯•åŸºç¡€æµç¨‹
python run_qt_slam.py --no-ai

# æ£€æŸ¥AIä¾èµ–
python -c "import torch; print(f'PyTorch: {torch.__version__}')"
```

### 4. æ€§èƒ½é—®é¢˜
- é™ä½ç›®æ ‡FPS
- å‡å°ç¼“å†²åŒºå¤§å°
- å…³é—­ä¸éœ€è¦çš„AIåŠŸèƒ½
- æ£€æŸ¥CPU/GPUä½¿ç”¨ç‡

## å¼€å‘è¯´æ˜

### æ–‡ä»¶ç»“æ„
```
hybrid_slam/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ video_stream_manager.py    # è§†é¢‘æµç®¡ç†
â”‚   â””â”€â”€ ai_processing_pipeline.py  # AIå¤„ç†ç®¡é“
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ qt_display_widget.py       # æ˜¾ç¤ºç»„ä»¶
â”‚   â””â”€â”€ main_window.py             # ä¸»çª—å£
â””â”€â”€ utils/
    â””â”€â”€ data_structures.py         # æ•°æ®ç»“æ„
```

### æ‰©å±•AIæ¨¡å‹
1. ç»§æ‰¿ç›¸åº”çš„åŸºç±»
2. å®ç°å¿…éœ€çš„æ¥å£æ–¹æ³•
3. åœ¨é…ç½®ä¸­å¯ç”¨æ–°æ¨¡å‹
4. æ›´æ–°å¤„ç†ç®¡é“

### è‡ªå®šä¹‰ç•Œé¢
1. ç»§æ‰¿QtDisplayWidget
2. é‡å†™æ˜¾ç¤ºæ–¹æ³•
3. æ·»åŠ æ–°çš„å¸ƒå±€å…ƒç´ 
4. è¿æ¥æ–°çš„ä¿¡å·æ§½

## ç‰ˆæœ¬ä¿¡æ¯

- **ç‰ˆæœ¬**: 1.0.0
- **æ¶æ„**: Qt5 + OpenCV + PyTorch
- **å…¼å®¹æ€§**: Windows/Linux/macOS
- **Python**: 3.7+

---

æ›´å¤šä¿¡æ¯è¯·å‚è€ƒï¼š
- è®¾è®¡æ–‡æ¡£ï¼š`design_document.md`
- æµ‹è¯•è„šæœ¬ï¼š`test_qt_slam.py`
- å¯åŠ¨è„šæœ¬ï¼š`run_qt_slam.py`